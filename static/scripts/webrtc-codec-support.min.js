!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t=n();for(var r in t)("object"==typeof exports?exports:e)[r]=t[r]}}(window,(function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n){e.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(e,a)}catch(e){o=[6,e],r=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.isWebrtcPublishCodecSupported=n.isWebrtcReceiveCodecSupported=n.WebrtcCodec=void 0;var o=t(2),a=function(){function e(e,n){this.type=e,this.payload=n}return e.VP8=new e("video",{channels:1,clockrate:9e4,id:"96",name:"VP8"}),e.VP9=new e("video",{channels:1,clockrate:9e4,id:"100",name:"VP9"}),e.H264=new e("video",{channels:1,clockrate:9e4,id:"97",name:"H264",parameters:[{key:"profile-level-id",value:"42C01F"},{key:"packetization-mode",value:"1"}]}),e.OPUS=new e("audio",{channels:2,clockrate:48e3,id:"111",name:"OPUS"}),e.ISAC=new e("audio",{channels:1,clockrate:16e3,id:"104",name:"ISAC"}),e}();n.WebrtcCodec=a,n.isWebrtcReceiveCodecSupported=function(e){var n,t;return r(this,void 0,void 0,(function(){var r,a,s,c,u,p,d,f,l,h,g;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),r={groups:[{contents:[e.type],semantics:"BUNDLE"}],contents:[{name:e.type,application:{applicationType:"rtp",media:e.type,mux:!0,payloads:[e.payload]},transport:{candidates:[],fingerprints:[{hash:"sha-256",setup:"actpass",value:Array(32).fill("00").join(":")}],pwd:"0".repeat(22),transportType:"iceUdp",ufrag:"0".repeat(8)}}]},a=o.toSessionSDP(r,{role:"initiator",direction:"outgoing"}),[4,(s=new RTCPeerConnection({iceServers:[]})).setRemoteDescription(new RTCSessionDescription({type:"offer",sdp:a}))];case 1:return i.sent(),[4,s.createAnswer()];case 2:if(c=i.sent(),void 0===(u=o.toSessionJSON(c.sdp,{role:"responder",direction:"outgoing"})).contents)return[2,!1];for(p=0,d=u.contents;p<d.length;p++)if(f=d[p],void 0!==(null===(n=f.application)||void 0===n?void 0:n.payloads))for(l=0,h=f.application.payloads;l<h.length;l++)if(g=h[l],(null===(t=null==g?void 0:g.name)||void 0===t?void 0:t.toUpperCase())===e.payload.name.toUpperCase())return[2,!0];return[2,!1];case 3:return i.sent(),[2,!1];case 4:return[2]}}))}))},n.isWebrtcPublishCodecSupported=function(e,n){var t,a;return r(this,void 0,void 0,(function(){var r,s,c,u,p,d,f,l,h,g,v,m,y,b;return i(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),r=new RTCPeerConnection({iceServers:[]}),"video"===n.type)for(s=0,c=e.getVideoTracks();s<c.length;s++)d=c[s],r.addTrack(d,e);else for(u=0,p=e.getAudioTracks();u<p.length;u++)d=p[u],r.addTrack(d,e);return[4,r.createOffer()];case 1:if(f=i.sent(),void 0===(l=o.toSessionJSON(f.sdp,{role:"initiator",direction:"outgoing"})).contents)return[2,!1];for(h=0,g=l.contents;h<g.length;h++)if(v=g[h],void 0!==(null===(t=v.application)||void 0===t?void 0:t.payloads))for(m=0,y=v.application.payloads;m<y.length;m++)if(b=y[m],(null===(a=null==b?void 0:b.name)||void 0===a?void 0:a.toUpperCase())===n.payload.name.toUpperCase())return[2,!0];return[2,!1];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))}},function(e,n,t){var r=t(3),i=t(4);n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,n){return i.toSessionJSON(e,{role:"responder",direction:"incoming",creators:n})},n.toOutgoingJSONOffer=function(e,n){return i.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:n})},n.toIncomingJSONAnswer=function(e,n){return i.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:n})},n.toOutgoingJSONAnswer=function(e,n){return i.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:n})},n.toIncomingMediaJSONOffer=function(e,n){return i.toMediaJSON(e,{role:"responder",direction:"incoming",creator:n})},n.toOutgoingMediaJSONOffer=function(e,n){return i.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:n})},n.toIncomingMediaJSONAnswer=function(e,n){return i.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:n})},n.toOutgoingMediaJSONAnswer=function(e,n){return i.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:n})},n.toCandidateJSON=i.toCandidateJSON,n.toMediaJSON=i.toMediaJSON,n.toSessionJSON=i.toSessionJSON},function(e,n,t){var r=t(0);n.toSessionSDP=function(e,t){t.role,t.direction;var r=["v=0","o=- "+(t.sid||e.sid||Date.now())+" "+(t.time||Date.now())+" IN IP4 0.0.0.0","s=-","t=0 0"],i=e.contents||[],o=!1;return i.forEach((function(e){e.application.sources&&e.application.sources.length&&(o=!0)})),o&&r.push("a=msid-semantic: WMS *"),(e.groups||[]).forEach((function(e){r.push("a=group:"+e.semantics+" "+e.contents.join(" "))})),i.forEach((function(e){r.push(n.toMediaSDP(e,t))})),r.join("\r\n")+"\r\n"},n.toMediaSDP=function(e,t){var i=[],o=t.role||"initiator",a=t.direction||"outgoing",s=e.application,c=e.transport,u=s.payloads||[],p=c&&c.fingerprints||[],d=[];if("datachannel"==s.applicationType?(d.push("application"),d.push("1"),d.push("DTLS/SCTP"),c.sctp&&c.sctp.forEach((function(e){d.push(e.number)}))):(d.push(s.media),d.push("1"),p.length>0?d.push("UDP/TLS/RTP/SAVPF"):s.encryption&&s.encryption.length>0?d.push("RTP/SAVPF"):d.push("RTP/AVPF"),u.forEach((function(e){d.push(e.id)}))),i.push("m="+d.join(" ")),i.push("c=IN IP4 0.0.0.0"),s.bandwidth&&s.bandwidth.type&&s.bandwidth.bandwidth&&i.push("b="+s.bandwidth.type+":"+s.bandwidth.bandwidth),"rtp"==s.applicationType&&i.push("a=rtcp:1 IN IP4 0.0.0.0"),c){c.ufrag&&i.push("a=ice-ufrag:"+c.ufrag),c.pwd&&i.push("a=ice-pwd:"+c.pwd);p.forEach((function(e){i.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&i.push("a=setup:"+e.setup)})),c.sctp&&c.sctp.forEach((function(e){i.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)}))}if("rtp"==s.applicationType&&i.push("a="+(r[o][a][e.senders]||"sendrecv")),i.push("a=mid:"+e.name),s.sources&&s.sources.length){var f={};s.sources.forEach((function(e){(e.parameters||[]).forEach((function(e){"msid"===e.key&&(f[e.value]=1)}))})),1===(f=Object.keys(f)).length&&i.push("a=msid:"+f[0])}return s.mux&&i.push("a=rtcp-mux"),s.rsize&&i.push("a=rtcp-rsize"),(s.encryption||[]).forEach((function(e){i.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))})),s.googConferenceFlag&&i.push("a=x-google-flag:conference"),u.forEach((function(e){var n="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(n+="/"+e.channels),i.push(n),e.parameters&&e.parameters.length){var t=["a=fmtp:"+e.id],r=[];e.parameters.forEach((function(e){r.push((e.key?e.key+"=":"")+e.value)})),t.push(r.join(";")),i.push(t.join(" "))}e.feedback&&e.feedback.forEach((function(n){"trr-int"===n.type?i.push("a=rtcp-fb:"+e.id+" trr-int "+(n.value?n.value:"0")):i.push("a=rtcp-fb:"+e.id+" "+n.type+(n.subtype?" "+n.subtype:""))}))})),s.feedback&&s.feedback.forEach((function(e){"trr-int"===e.type?i.push("a=rtcp-fb:* trr-int "+(e.value?e.value:"0")):i.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))})),(s.headerExtensions||[]).forEach((function(e){i.push("a=extmap:"+e.id+(e.senders?"/"+r[o][a][e.senders]:"")+" "+e.uri)})),(s.sourceGroups||[]).forEach((function(e){i.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))})),(s.sources||[]).forEach((function(e){for(var n=0;n<e.parameters.length;n++){var t=e.parameters[n];i.push("a=ssrc:"+(e.ssrc||s.ssrc)+" "+t.key+(t.value?":"+t.value:""))}})),(c.candidates||[]).forEach((function(e){i.push(n.toCandidateSDP(e))})),i.join("\r\n")},n.toCandidateSDP=function(e){var n=[];n.push(e.foundation),n.push(e.component),n.push(e.protocol.toUpperCase()),n.push(e.priority),n.push(e.ip),n.push(e.port);var t=e.type;return n.push("typ"),n.push(t),"srflx"!==t&&"prflx"!==t&&"relay"!==t||e.relAddr&&e.relPort&&(n.push("raddr"),n.push(e.relAddr),n.push("rport"),n.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(n.push("tcptype"),n.push(e.tcpType)),n.push("generation"),n.push(e.generation||"0"),"a=candidate:"+n.join(" ")}},function(e,n,t){var r=t(0),i=t(5),o=Math.random();n._setIdCounter=function(e){o=e},n.toSessionJSON=function(e,t){var r,o=t.creators||[],a=t.role||"initiator",s=t.direction||"outgoing",c=e.split(/\r?\nm=/);for(r=1;r<c.length;r++)c[r]="m="+c[r],r!==c.length-1&&(c[r]+="\r\n");var u=c.shift()+"\r\n",p=i.lines(u),d={},f=[];for(r=0;r<c.length;r++)f.push(n.toMediaJSON(c[r],u,{role:a,direction:s,creator:o[r]||"initiator"}));d.contents=f;var l=i.findLines("a=group:",p);return l.length&&(d.groups=i.groups(l)),d},n.toMediaJSON=function(e,t,o){var a=o.creator||"initiator",s=o.role||"initiator",c=o.direction||"outgoing",u=i.lines(e),p=i.lines(t),d=i.mline(u[0]),f={creator:a,name:d.media,application:{applicationType:"rtp",media:d.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==d.media&&(f.application={applicationType:"datachannel"},f.transport.sctp=[]);var l=f.application,h=f.transport,g=i.findLine("a=mid:",u);if(g&&(f.name=g.substr(6)),i.findLine("a=sendrecv",u,p)?f.senders="both":i.findLine("a=sendonly",u,p)?f.senders=r[s][c].sendonly:i.findLine("a=recvonly",u,p)?f.senders=r[s][c].recvonly:i.findLine("a=inactive",u,p)&&(f.senders="none"),"rtp"==l.applicationType){var v=i.findLine("b=",u);v&&(l.bandwidth=i.bandwidth(v));var m=i.findLine("a=ssrc:",u);m&&(l.ssrc=m.substr(7).split(" ")[0]),i.findLines("a=rtpmap:",u).forEach((function(e){var n=i.rtpmap(e);n.parameters=[],n.feedback=[],i.findLines("a=fmtp:"+n.id,u).forEach((function(e){n.parameters=i.fmtp(e)})),i.findLines("a=rtcp-fb:"+n.id,u).forEach((function(e){n.feedback.push(i.rtcpfb(e))})),l.payloads.push(n)})),i.findLines("a=crypto:",u,p).forEach((function(e){l.encryption.push(i.crypto(e))})),i.findLine("a=rtcp-mux",u)&&(l.mux=!0),i.findLine("a=rtcp-rsize",u)&&(l.rsize=!0),i.findLines("a=rtcp-fb:*",u).forEach((function(e){l.feedback.push(i.rtcpfb(e))})),i.findLines("a=extmap:",u).forEach((function(e){var n=i.extmap(e);n.senders=r[s][c][n.senders],l.headerExtensions.push(n)}));var y=i.findLines("a=ssrc-group:",u);l.sourceGroups=i.sourceGroups(y||[]);var b=i.findLines("a=ssrc:",u),S=l.sources=i.sources(b||[]),P=i.findLine("a=msid:",u);if(P){var O=i.msid(P);["msid","mslabel","label"].forEach((function(e){for(var n=0;n<S.length;n++){for(var t=!1,r=0;r<S[n].parameters.length;r++)S[n].parameters[r].key===e&&(t=!0);t||S[n].parameters.push({key:e,value:O[e]})}}))}i.findLine("a=x-google-flag:conference",u,p)&&(l.googConferenceFlag=!0)}var w=i.findLines("a=fingerprint:",u,p),k=i.findLine("a=setup:",u,p);w.forEach((function(e){var n=i.fingerprint(e);k&&(n.setup=k.substr(8)),h.fingerprints.push(n)}));var D=i.findLine("a=ice-ufrag:",u,p),x=i.findLine("a=ice-pwd:",u,p);D&&x&&(h.ufrag=D.substr(12),h.pwd=x.substr(10),h.candidates=[],i.findLines("a=candidate:",u,p).forEach((function(e){h.candidates.push(n.toCandidateJSON(e))})));"datachannel"==l.applicationType&&i.findLines("a=sctpmap:",u).forEach((function(e){var n=i.sctpmap(e);h.sctp.push(n)}));return f},n.toCandidateJSON=function(e){var n=i.candidate(e.split(/\r?\n/)[0]);return n.id=(o++).toString(36).substr(0,12),n}},function(e,n){n.lines=function(e){return e.split(/\r?\n/).filter((function(e){return e.length>0}))},n.findLine=function(e,n,t){for(var r=e.length,i=0;i<n.length;i++)if(n[i].substr(0,r)===e)return n[i];if(!t)return!1;for(var o=0;o<t.length;o++)if(t[o].substr(0,r)===e)return t[o];return!1},n.findLines=function(e,n,t){for(var r=[],i=e.length,o=0;o<n.length;o++)n[o].substr(0,i)===e&&r.push(n[o]);if(r.length||!t)return r;for(var a=0;a<t.length;a++)t[a].substr(0,i)===e&&r.push(t[a]);return r},n.mline=function(e){for(var n=e.substr(2).split(" "),t={media:n[0],port:n[1],proto:n[2],formats:[]},r=3;r<n.length;r++)n[r]&&t.formats.push(n[r]);return t},n.rtpmap=function(e){var n=e.substr(9).split(" "),t={id:n.shift()};return n=n[0].split("/"),t.name=n[0],t.clockrate=n[1],t.channels=3==n.length?n[2]:"1",t},n.sctpmap=function(e){var n=e.substr(10).split(" ");return{number:n.shift(),protocol:n.shift(),streams:n.shift()}},n.fmtp=function(e){for(var n,t,r,i=e.substr(e.indexOf(" ")+1).split(";"),o=[],a=0;a<i.length;a++)t=(n=i[a].split("="))[0].trim(),r=n[1],t&&r?o.push({key:t,value:r}):t&&o.push({key:"",value:t});return o},n.crypto=function(e){var n=e.substr(9).split(" ");return{tag:n[0],cipherSuite:n[1],keyParams:n[2],sessionParams:n.slice(3).join(" ")}},n.fingerprint=function(e){var n=e.substr(14).split(" ");return{hash:n[0],value:n[1]}},n.extmap=function(e){var n=e.substr(9).split(" "),t={},r=n.shift(),i=r.indexOf("/");return i>=0?(t.id=r.substr(0,i),t.senders=r.substr(i+1)):(t.id=r,t.senders="sendrecv"),t.uri=n.shift()||"",t},n.rtcpfb=function(e){var n=e.substr(10).split(" "),t={};return t.id=n.shift(),t.type=n.shift(),"trr-int"===t.type?t.value=n.shift():t.subtype=n.shift()||"",t.parameters=n,t},n.candidate=function(e){for(var n,t={foundation:(n=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:n[1],protocol:n[2].toLowerCase(),priority:n[3],ip:n[4],port:n[5],type:n[7],generation:"0"},r=8;r<n.length;r+=2)"raddr"===n[r]?t.relAddr=n[r+1]:"rport"===n[r]?t.relPort=n[r+1]:"generation"===n[r]?t.generation=n[r+1]:"tcptype"===n[r]&&(t.tcpType=n[r+1]);return t.network="1",t},n.sourceGroups=function(e){for(var n=[],t=0;t<e.length;t++){var r=e[t].substr(13).split(" ");n.push({semantics:r.shift(),sources:r})}return n},n.sources=function(e){for(var n=[],t={},r=0;r<e.length;r++){var i=e[r].substr(7).split(" "),o=i.shift();if(!t[o]){var a={ssrc:o,parameters:[]};n.push(a),t[o]=a}var s=(i=i.join(" ").split(":")).shift(),c=i.join(":")||null;t[o].parameters.push({key:s,value:c})}return n},n.groups=function(e){for(var n,t=[],r=0;r<e.length;r++)n=e[r].substr(8).split(" "),t.push({semantics:n.shift(),contents:n});return t},n.bandwidth=function(e){var n=e.substr(2).split(":"),t={};return t.type=n.shift(),t.bandwidth=n.shift(),t},n.msid=function(e){var n=e.substr(7),t=n.split(" ");return{msid:n,mslabel:t[0],label:t[1]}}}])}));